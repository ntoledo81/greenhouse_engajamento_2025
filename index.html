<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>An√°lise Greenhouse - Edify</title>
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Ubuntu', Arial, sans-serif;
            background: linear-gradient(135deg, #F2F2F2 0%, #E8E8E8 100%);
            padding: 0;
            overflow-x: hidden;
        }
        
        /* Banner Principal */
        .main-banner {
            background: linear-gradient(135deg, #4219B5 0%, #5a3ed6 100%);
            color: #FFFFFF;
            padding: 40px 20px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(66, 25, 181, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .main-banner::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: pulse 15s ease-in-out infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1) rotate(0deg); }
            50% { transform: scale(1.1) rotate(180deg); }
        }
        
        .banner-content {
            position: relative;
            z-index: 1;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .banner-title {
            font-size: 42px;
            font-weight: bold;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
            letter-spacing: 1px;
        }
        
        .banner-subtitle {
            font-size: 22px;
            opacity: 0.95;
            font-weight: 400;
            margin-bottom: 10px;
        }
        
        .banner-period {
            font-size: 18px;
            opacity: 0.85;
            font-style: italic;
            background-color: rgba(255,255,255,0.2);
            display: inline-block;
            padding: 8px 20px;
            border-radius: 20px;
            margin-top: 10px;
        }
        
        /* Container Principal */
        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        
        /* Navega√ß√£o por Abas */
        .tabs-container {
            background-color: #FFFFFF;
            border-radius: 15px 15px 0 0;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.05);
            overflow: hidden;
            margin-bottom: 0;
        }
        
        .tabs {
            display: flex;
            background-color: #F2F2F2;
            border-bottom: 3px solid #4219B5;
        }
        
        .tab-button {
            flex: 1;
            padding: 20px;
            background-color: transparent;
            border: none;
            cursor: pointer;
            font-family: 'Ubuntu', Arial, sans-serif;
            font-size: 16px;
            font-weight: bold;
            color: #242426;
            transition: all 0.3s ease;
            position: relative;
            text-align: center;
        }
        
        .tab-button:hover {
            background-color: rgba(66, 25, 181, 0.1);
        }
        
        .tab-button.active {
            background-color: #FFFFFF;
            color: #4219B5;
        }
        
        .tab-button.active::after {
            content: '';
            position: absolute;
            bottom: -3px;
            left: 0;
            right: 0;
            height: 3px;
            background-color: #00AA9E;
        }
        
        .tab-icon {
            font-size: 24px;
            display: block;
            margin-bottom: 8px;
        }
        
        /* Conte√∫do das Abas */
        .content-container {
            background-color: #FFFFFF;
            border-radius: 0 0 15px 15px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
            padding: 40px;
        }
        
        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease-in;
        }
        
        .tab-content.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Cabe√ßalho de cada se√ß√£o */
        .section-header {
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 2px solid #F2F2F2;
        }
        
        .section-title {
            font-size: 28px;
            color: #4219B5;
            margin-bottom: 10px;
            font-weight: bold;
        }
        
        .section-description {
            font-size: 16px;
            color: #242426;
            line-height: 1.6;
        }
        
        /* Gr√°ficos */
        .chart-container {
            width: 100%;
            min-height: 600px;
            margin: 20px 0;
        }
        
        /* Cards de Insights */
        .insights-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        
        .insight-card {
            background: linear-gradient(135deg, #F2F2F2 0%, #E8E8E8 100%);
            padding: 25px;
            border-radius: 10px;
            border-left: 5px solid;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .insight-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }
        
        .insight-card.green { border-left-color: #00AA9E; }
        .insight-card.blue { border-left-color: #4CD1F6; }
        .insight-card.yellow { border-left-color: #FFC20E; }
        .insight-card.red { border-left-color: #FF2726; }
        
        .insight-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .insight-icon {
            font-size: 32px;
            margin-right: 15px;
        }
        
        .insight-title {
            font-size: 18px;
            font-weight: bold;
            color: #4219B5;
        }
        
        .insight-text {
            font-size: 14px;
            color: #242426;
            line-height: 1.6;
        }
        
        /* Accordion/Dropdown para Tutorial Radar */
        .help-accordion {
            margin-top: 30px;
            border: 2px solid #4219B5;
            border-radius: 10px;
            overflow: hidden;
            background-color: #FFFFFF;
        }
        
        .accordion-header {
            background: linear-gradient(135deg, #4219B5 0%, #5a3ed6 100%);
            color: #FFFFFF;
            padding: 15px 20px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background 0.3s ease;
            user-select: none;
        }
        
        .accordion-header:hover {
            background: linear-gradient(135deg, #5a3ed6 0%, #4219B5 100%);
        }
        
        .accordion-title {
            font-size: 18px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .accordion-icon {
            font-size: 20px;
            transition: transform 0.3s ease;
        }
        
        .accordion-icon.open {
            transform: rotate(180deg);
        }
        
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease, padding 0.4s ease;
            background-color: #F2F2F2;
        }
        
        .accordion-content.open {
            max-height: 2000px;
            padding: 25px 20px;
        }
        
        .accordion-section {
            background-color: #FFFFFF;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .accordion-section:last-child {
            margin-bottom: 0;
        }
        
        .accordion-section h4 {
            color: #4219B5;
            margin-bottom: 15px;
            font-size: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .tutorial-radar-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .tutorial-item {
            background-color: #F2F2F2;
            padding: 15px;
            border-radius: 8px;
            border-left: 3px solid #00AA9E;
        }
        
        .tutorial-item-title {
            font-weight: bold;
            margin-bottom: 8px;
            font-size: 16px;
            color: #4219B5;
        }
        
        .tutorial-item-text {
            font-size: 14px;
            color: #242426;
            line-height: 1.5;
        }
        
        .dimension-item {
            display: flex;
            align-items: center;
            padding: 15px;
            background-color: #F2F2F2;
            border-radius: 8px;
            margin-bottom: 15px;
        }
        
        .dimension-item:last-child {
            margin-bottom: 0;
        }
        
        .dimension-emoji {
            font-size: 32px;
            margin-right: 20px;
            min-width: 50px;
            text-align: center;
        }
        
        .dimension-content {
            flex: 1;
        }
        
        .dimension-name {
            font-size: 18px;
            font-weight: bold;
            color: #4219B5;
            margin-bottom: 5px;
        }
        
        .dimension-desc {
            font-size: 14px;
            color: #242426;
        }
        
        /* Footer */
        .dashboard-footer {
            text-align: center;
            padding: 30px;
            background-color: #242426;
            color: #FFFFFF;
            margin-top: 40px;
            border-radius: 15px;
        }
        
        .dashboard-footer p {
            margin: 5px 0;
            font-size: 14px;
        }
        
        .dashboard-footer strong {
            color: #00AA9E;
        }
        
        /* Responsividade */
        @media (max-width: 768px) {
            .banner-title {
                font-size: 28px;
            }
            
            .banner-subtitle {
                font-size: 18px;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .tab-button {
                border-bottom: 1px solid #E8E8E8;
            }
            
            .content-container {
                padding: 20px;
            }
            
            .tutorial-radar-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Banner Principal -->
    <div class="main-banner">
        <div class="banner-content">
            <div class="banner-title">üå± An√°lise Greenhouse: T√≥picos Escolhidos vs. Atividades Conclu√≠das</div>
            <div class="banner-subtitle">Dashboard Interativo de Engajamento Educacional</div>
            <div class="banner-period">üìÖ Per√≠odo: 09/07/2025 - 07/10/2025</div>
        </div>
    </div>

    <!-- Container Principal -->
    <div class="container">
        <!-- Navega√ß√£o por Abas -->
        <div class="tabs-container">
            <div class="tabs">
                <button class="tab-button active" onclick="showTab('bubble')">
                    <span class="tab-icon">‚ö™</span>
                    Bubble Chart
                </button>
                <button class="tab-button" onclick="showTab('bars')">
                    <span class="tab-icon">üìä</span>
                    Barras Comparativas
                </button>
                <button class="tab-button" onclick="showTab('radar')">
                    <span class="tab-icon">üéØ</span>
                    Radar Multidimensional
                </button>
            </div>
        </div>

        <div class="content-container">
            <!-- TAB 1: BUBBLE CHART -->
            <div id="bubble" class="tab-content active">
                <div class="section-header">
                    <h2 class="section-title">‚ö™ An√°lise de Bolhas: Escolhas vs Conclus√µes</h2>
                    <p class="section-description">
                        Visualize a rela√ß√£o entre o n√∫mero de escolhas e conclus√µes. O tamanho de cada bolha representa 
                        a taxa de conclus√£o. Cores indicam performance: <strong style="color: #00AA9E;">Verde</strong> (‚â•100%), 
                        <strong style="color: #FFC20E;">Amarelo</strong> (50-100%), <strong style="color: #FF2726;">Vermelho</strong> (<50%).
                    </p>
                </div>
                
                <div id="bubbleChart" class="chart-container"></div>
                
                <div class="insights-grid">
                    <div class="insight-card green">
                        <div class="insight-header">
                            <span class="insight-icon">üèÜ</span>
                            <div class="insight-title">Campe√µes de Reengajamento</div>
                        </div>
                        <div class="insight-text">
                            4 t√≥picos (em verde) t√™m taxa superior a 100%, indicando que alunos completam 
                            m√∫ltiplas atividades. <strong>International Literacy Day lidera com 287%!</strong>
                        </div>
                    </div>
                    
                    <div class="insight-card blue">
                        <div class="insight-header">
                            <span class="insight-icon">üë•</span>
                            <div class="insight-title">Popularidade x Convers√£o</div>
                        </div>
                        <div class="insight-text">
                            <strong>Cats & Dogs</strong> √© o mais escolhido (3.761 vezes), mas tem taxa moderada (75,6%). 
                            Grande oportunidade para melhorar a reten√ß√£o.
                        </div>
                    </div>
                    
                    <div class="insight-card yellow">
                        <div class="insight-header">
                            <span class="insight-icon">‚ö°</span>
                            <div class="insight-title">Linha de Refer√™ncia</div>
                        </div>
                        <div class="insight-text">
                            A linha tracejada representa 100% (1 conclus√£o por escolha). T√≥picos <strong>acima</strong> 
                            desta linha t√™m reengajamento excepcional.
                        </div>
                    </div>
                </div>
            </div>

            <!-- TAB 2: BARRAS COMPARATIVAS -->
            <div id="bars" class="tab-content">
                <div class="section-header">
                    <h2 class="section-title">üìä Comparativo: Escolhas vs Conclus√µes</h2>
                    <p class="section-description">
                        Visualiza√ß√£o lado a lado do interesse inicial (escolhas em azul) versus atividades completadas 
                        (conclus√µes em verde). Ordenado por taxa de conclus√£o crescente. As porcentagens √† esquerda 
                        mostram a efici√™ncia de convers√£o de cada t√≥pico.
                    </p>
                </div>
                
                <div id="barsChart" class="chart-container"></div>
                
                <div class="insights-grid">
                    <div class="insight-card red">
                        <div class="insight-header">
                            <span class="insight-icon">‚ö†Ô∏è</span>
                            <div class="insight-title">Oportunidades de Melhoria</div>
                        </div>
                        <div class="insight-text">
                            <strong>Japan</strong> (32,3%) e <strong>Football</strong> (39,2%) t√™m alta popularidade 
                            mas baixa conclus√£o. Investigar poss√≠veis barreiras: dificuldade, tempo ou relev√¢ncia.
                        </div>
                    </div>
                    
                    <div class="insight-card green">
                        <div class="insight-header">
                            <span class="insight-icon">üìà</span>
                            <div class="insight-title">Invers√£o de Sucesso</div>
                        </div>
                        <div class="insight-text">
                            T√≥picos no topo (International Literacy Day, Brazilian Folklore) t√™m MAIS conclus√µes 
                            que escolhas! Alunos voltam repetidamente para explorar diferentes atividades.
                        </div>
                    </div>
                    
                    <div class="insight-card blue">
                        <div class="insight-header">
                            <span class="insight-icon">üéØ</span>
                            <div class="insight-title">Zona de Excel√™ncia</div>
                        </div>
                        <div class="insight-text">
                            <strong>Colours</strong> (67,8%) e <strong>Cats & Dogs</strong> (75,6%) est√£o pr√≥ximos 
                            da taxa ideal. Com pequenos ajustes, podem alcan√ßar 100%.
                        </div>
                    </div>
                </div>
            </div>

            <!-- TAB 3: RADAR -->
            <div id="radar" class="tab-content">
                <div class="section-header">
                    <h2 class="section-title">üéØ An√°lise Multidimensional: Gr√°fico de Radar</h2>
                    <p class="section-description">
                        Compare os Top 5 t√≥picos em 3 dimens√µes simultaneamente. Cada eixo representa uma m√©trica diferente, 
                        normalizada de 0 a 100. Formas mais equilibradas indicam performance consistente em todas as √°reas.
                    </p>
                </div>
                
                <div id="radarChart" class="chart-container"></div>
                
                <!-- Accordion de Ajuda -->
                <div class="help-accordion">
                    <div class="accordion-header" onclick="toggleAccordion()">
                        <div class="accordion-title">
                            <span>üí°</span>
                            <span>Como interpretar este gr√°fico?</span>
                        </div>
                        <span class="accordion-icon" id="accordionIcon">‚ñº</span>
                    </div>
                    <div class="accordion-content" id="accordionContent">
                        <!-- Se√ß√£o 1: Como Interpretar -->
                        <div class="accordion-section">
                            <h4>üéì Como Interpretar o Gr√°fico de Radar?</h4>
                            <div class="tutorial-radar-grid">
                                <div class="tutorial-item">
                                    <div class="tutorial-item-title">‚≠ï Formas Redondas</div>
                                    <div class="tutorial-item-text">
                                        Indicam performance equilibrada em todas as dimens√µes. 
                                        T√≥picos "completos" e consistentes.
                                    </div>
                                </div>
                                <div class="tutorial-item">
                                    <div class="tutorial-item-title">üî∫ Formas Pontiagudas</div>
                                    <div class="tutorial-item-text">
                                        Mostram destaque em uma dimens√£o espec√≠fica. 
                                        Ex: alta taxa mas baixa popularidade.
                                    </div>
                                </div>
                                <div class="tutorial-item">
                                    <div class="tutorial-item-title">üìè √Årea Preenchida</div>
                                    <div class="tutorial-item-text">
                                        Quanto maior a √°rea colorida, maior o impacto 
                                        geral do t√≥pico. Compare visualmente!
                                    </div>
                                </div>
                                <div class="tutorial-item">
                                    <div class="tutorial-item-title">üéÆ Analogia</div>
                                    <div class="tutorial-item-text">
                                        Como stats de personagens em jogos: for√ßa, 
                                        velocidade, defesa. Aqui: popularidade, conclus√µes, taxa.
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Se√ß√£o 2: Dimens√µes -->
                        <div class="accordion-section">
                            <h4>üìä O que cada eixo representa?</h4>
                            
                            <div class="dimension-item">
                                <div class="dimension-emoji">üë•</div>
                                <div class="dimension-content">
                                    <div class="dimension-name">Popularidade (Escolhas)</div>
                                    <div class="dimension-desc">
                                        Quantos alunos escolheram este t√≥pico. Mede atratividade e interesse inicial.
                                        <strong>Cats & Dogs = 100 pontos</strong> (3.761 escolhas).
                                    </div>
                                </div>
                            </div>
                            
                            <div class="dimension-item">
                                <div class="dimension-emoji">‚úÖ</div>
                                <div class="dimension-content">
                                    <div class="dimension-name">Conclus√µes Efetivas</div>
                                    <div class="dimension-desc">
                                        Volume total de atividades completadas. Mede produtividade.
                                        <strong>Brazilian Folklore = 100 pontos</strong> (3.439 conclus√µes).
                                    </div>
                                </div>
                            </div>
                            
                            <div class="dimension-item">
                                <div class="dimension-emoji">üéØ</div>
                                <div class="dimension-content">
                                    <div class="dimension-name">Taxa de Reten√ß√£o (%)</div>
                                    <div class="dimension-desc">
                                        Rela√ß√£o entre escolhas e conclus√µes. Mede engajamento e reengajamento.
                                        <strong>International Literacy Day = 100 pontos</strong> (287% de taxa).
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="insights-grid">
                    <div class="insight-card green">
                        <div class="insight-header">
                            <span class="insight-icon">üèÜ</span>
                            <div class="insight-title">International Literacy Day</div>
                        </div>
                        <div class="insight-text">
                            <strong>Forma:</strong> Tri√¢ngulo pontiagudo na Taxa<br>
                            <strong>Insight:</strong> N√£o √© o mais popular, mas tem reengajamento ALT√çSSIMO (287%). 
                            F√≥rmula de sucesso a replicar!
                        </div>
                    </div>
                    
                    <div class="insight-card blue">
                        <div class="insight-header">
                            <span class="insight-icon">‚≠ê</span>
                            <div class="insight-title">Cats & Dogs</div>
                        </div>
                        <div class="insight-text">
                            <strong>Forma:</strong> Pico na Popularidade<br>
                            <strong>Insight:</strong> L√≠der absoluto em escolhas, mas taxa moderada. 
                            Adicionar incentivos para conclus√£o pode transform√°-lo em campe√£o completo.
                        </div>
                    </div>
                    
                    <div class="insight-card yellow">
                        <div class="insight-header">
                            <span class="insight-icon">üå±</span>
                            <div class="insight-title">Brazilian Folklore</div>
                        </div>
                        <div class="insight-text">
                            <strong>Forma:</strong> Equilibrado entre Conclus√µes e Taxa<br>
                            <strong>Insight:</strong> Performance s√≥lida em m√∫ltiplas dimens√µes (226% taxa). 
                            Modelo de excel√™ncia!
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="dashboard-footer">
            <p><strong>üå± Edify Greenhouse Analytics</strong></p>
            <p>Dashboard gerado em: 17/11/2025 | Criado por: <strong>@ntoledo81</strong></p>
            <p>üí° Desenvolvido com Plotly.js + Identidade Visual Edify</p>
        </div>
    </div>

    <script>
        // ============================================
        // DADOS
        // ============================================
        const dados = [
            {topico: 'International Literacy Day üìö', topicoSimples: 'International Literacy Day', escolhas: 1026, conclusoes: 2945, taxa: 287.0},
            {topico: 'Brazilian Folklore üé≠', topicoSimples: 'Brazilian Folklore', escolhas: 1522, conclusoes: 3439, taxa: 226.0},
            {topico: 'Gardening üå±', topicoSimples: 'Gardening', escolhas: 1322, conclusoes: 2704, taxa: 204.5},
            {topico: 'Great Transformations ü¶ã', topicoSimples: 'Great Transformations', escolhas: 1087, conclusoes: 2177, taxa: 200.3},
            {topico: 'Cats & Dogs üê±üê∂', topicoSimples: 'Cats & Dogs', escolhas: 3761, conclusoes: 2843, taxa: 75.6},
            {topico: 'Colours üåà', topicoSimples: 'Colours', escolhas: 1632, conclusoes: 1106, taxa: 67.8},
            {topico: 'Dinosaurs ü¶ï', topicoSimples: 'Dinosaurs', escolhas: 2858, conclusoes: 1515, taxa: 53.0},
            {topico: 'Drawing & Painting üé®', topicoSimples: 'Drawing & Painting', escolhas: 1943, conclusoes: 899, taxa: 46.3},
            {topico: 'Football ‚öΩ', topicoSimples: 'Football', escolhas: 2087, conclusoes: 818, taxa: 39.2},
            {topico: 'Japan üáØüáµ', topicoSimples: 'Japan', escolhas: 2023, conclusoes: 654, taxa: 32.3}
        ];

        // Cores Edify
        const cores = {
            green: '#00AA9E',
            yellow: '#FFC20E',
            red: '#FF2726',
            dark_blue: '#4219B5',
            light_blue: '#4CD1F6',
            light_gray: '#F2F2F2'
        };

        // Fun√ß√£o para categorizar
        function getColorAndCategory(rate) {
            if (rate >= 100) return {color: cores.green, category: 'Excelente (‚â•100%)'};
            if (rate >= 50) return {color: cores.yellow, category: 'Bom (50-100%)'};
            return {color: cores.red, category: 'Aten√ß√£o (<50%)'};
        }

        // ============================================
        // FUN√á√ïES DE NAVEGA√á√ÉO
        // ============================================
        function showTab(tabName) {
            // Esconder todos os conte√∫dos
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Remover active de todos os bot√µes
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
            });
            
            // Mostrar conte√∫do selecionado
            document.getElementById(tabName).classList.add('active');
            
            // Ativar bot√£o correspondente
            event.target.closest('.tab-button').classList.add('active');
            
            // Renderizar gr√°fico se ainda n√£o foi renderizado
            if (tabName === 'bubble' && !window.bubbleRendered) {
                createBubbleChart();
                window.bubbleRendered = true;
            } else if (tabName === 'bars' && !window.barsRendered) {
                createBarsChart();
                window.barsRendered = true;
            } else if (tabName === 'radar' && !window.radarRendered) {
                createRadarChart();
                window.radarRendered = true;
            }
        }

        // ============================================
        // FUN√á√ÉO DO ACCORDION
        // ============================================
        function toggleAccordion() {
            const content = document.getElementById('accordionContent');
            const icon = document.getElementById('accordionIcon');
            
            content.classList.toggle('open');
            icon.classList.toggle('open');
        }

        // ============================================
        // BUBBLE CHART
        // ============================================
        function createBubbleChart() {
            const excelente = dados.filter(d => d.taxa >= 100);
            const bom = dados.filter(d => d.taxa >= 50 && d.taxa < 100);
            const atencao = dados.filter(d => d.taxa < 50);

            const traces = [
                {
                    x: excelente.map(d => d.escolhas),
                    y: excelente.map(d => d.conclusoes),
                    mode: 'markers',
                    name: 'Excelente (‚â•100%)',
                    marker: {
                        size: excelente.map(d => d.taxa * 0.25),
                        color: cores.green,
                        line: {color: cores.dark_blue, width: 2},
                        opacity: 0.8
                    },
                    text: excelente.map(d => d.topico),
                    customdata: excelente.map(d => [d.taxa, d.escolhas, d.conclusoes]),
                    hovertemplate: '<b>%{text}</b><br>' +
                                  'Escolhas: %{customdata[1]:,}<br>' +
                                  'Conclus√µes: %{customdata[2]:,}<br>' +
                                  'Taxa: %{customdata[0]:.1f}%<br>' +
                                  '<extra></extra>'
                },
                {
                    x: bom.map(d => d.escolhas),
                    y: bom.map(d => d.conclusoes),
                    mode: 'markers',
                    name: 'Bom (50-100%)',
                    marker: {
                        size: bom.map(d => d.taxa * 0.25),
                        color: cores.yellow,
                        line: {color: cores.dark_blue, width: 2},
                        opacity: 0.8
                    },
                    text: bom.map(d => d.topico),
                    customdata: bom.map(d => [d.taxa, d.escolhas, d.conclusoes]),
                    hovertemplate: '<b>%{text}</b><br>' +
                                  'Escolhas: %{customdata[1]:,}<br>' +
                                  'Conclus√µes: %{customdata[2]:,}<br>' +
                                  'Taxa: %{customdata[0]:.1f}%<br>' +
                                  '<extra></extra>'
                },
                {
                    x: atencao.map(d => d.escolhas),
                    y: atencao.map(d => d.conclusoes),
                    mode: 'markers',
                    name: 'Aten√ß√£o (<50%)',
                    marker: {
                        size: atencao.map(d => d.taxa * 0.25),
                        color: cores.red,
                        line: {color: cores.dark_blue, width: 2},
                        opacity: 0.8
                    },
                    text: atencao.map(d => d.topico),
                    customdata: atencao.map(d => [d.taxa, d.escolhas, d.conclusoes]),
                    hovertemplate: '<b>%{text}</b><br>' +
                                  'Escolhas: %{customdata[1]:,}<br>' +
                                  'Conclus√µes: %{customdata[2]:,}<br>' +
                                  'Taxa: %{customdata[0]:.1f}%<br>' +
                                  '<extra></extra>'
                }
            ];

            // Linha de refer√™ncia 1:1
            const maxVal = Math.max(...dados.map(d => Math.max(d.escolhas, d.conclusoes)));
            traces.push({
                x: [0, maxVal],
                y: [0, maxVal],
                mode: 'lines',
                name: 'Linha 1:1 (100%)',
                line: {color: cores.dark_blue, width: 2, dash: 'dash'},
                hoverinfo: 'skip',
                showlegend: true
            });

            const layout = {
                xaxis: {
                    title: '<b>N√∫mero de Escolhas</b>',
                    gridcolor: 'rgba(0,0,0,0.1)',
                    showgrid: true
                },
                yaxis: {
                    title: '<b>N√∫mero de Conclus√µes</b>',
                    gridcolor: 'rgba(0,0,0,0.1)',
                    showgrid: true
                },
                plot_bgcolor: cores.light_gray,
                paper_bgcolor: '#FFFFFF',
                font: {family: 'Ubuntu, Arial, sans-serif', color: '#242426'},
                hovermode: 'closest',
                legend: {
                    orientation: 'v',
                    yanchor: 'top',
                    y: 1,
                    xanchor: 'left',
                    x: 0.01,
                    bgcolor: 'rgba(255,255,255,0.95)',
                    bordercolor: cores.dark_blue,
                    borderwidth: 2
                },
                margin: {t: 20, b: 60, l: 80, r: 40}
            };

            const config = {
                responsive: true,
                displayModeBar: true,
                displaylogo: false,
                modeBarButtonsToRemove: ['lasso2d', 'select2d'],
                toImageButtonOptions: {
                    format: 'png',
                    filename: 'edify_bubble_chart',
                    height: 700,
                    width: 1200,
                    scale: 2
                }
            };

            Plotly.newPlot('bubbleChart', traces, layout, config);
        }

        // ============================================
        // BARRAS COMPARATIVAS
        // ============================================
        function createBarsChart() {
            const dadosSorted = [...dados].sort((a, b) => a.taxa - b.taxa);

            const traceEscolhas = {
                y: dadosSorted.map(d => d.topico),
                x: dadosSorted.map(d => d.escolhas),
                name: 'Escolhas',
                type: 'bar',
                orientation: 'h',
                marker: {
                    color: cores.light_blue,
                    line: {color: cores.dark_blue, width: 1.5}
                },
                text: dadosSorted.map(d => d.escolhas.toLocaleString('pt-BR')),
                textposition: 'outside',
                textfont: {size: 11, color: '#242426', family: 'Ubuntu'},
                hovertemplate: '<b>Escolhas</b>: %{x:,}<extra></extra>'
            };

            const traceConclusoes = {
                y: dadosSorted.map(d => d.topico),
                x: dadosSorted.map(d => d.conclusoes),
                name: 'Conclus√µes',
                type: 'bar',
                orientation: 'h',
                marker: {
                    color: cores.green,
                    line: {color: cores.dark_blue, width: 1.5}
                },
                text: dadosSorted.map(d => d.conclusoes.toLocaleString('pt-BR')),
                textposition: 'outside',
                textfont: {size: 11, color: '#242426', family: 'Ubuntu'},
                hovertemplate: '<b>Conclus√µes</b>: %{x:,}<extra></extra>'
            };

            const annotations = dadosSorted.map(d => {
                const colorData = getColorAndCategory(d.taxa);
                return {
                    x: 0,
                    y: d.topico,
                    text: `<b>${d.taxa.toFixed(0)}%</b>`,
                    xanchor: 'right',
                    xref: 'x',
                    yref: 'y',
                    showarrow: false,
                    font: {size: 12, color: colorData.color, family: 'Ubuntu', weight: 'bold'},
                    bgcolor: '#FFFFFF',
                    bordercolor: colorData.color,
                    borderwidth: 2,
                    borderpad: 4,
                    xshift: -10
                };
            });

            const layout = {
                barmode: 'group',
                bargap: 0.15,
                bargroupgap: 0.1,
                xaxis: {
                    title: '',  // Removido "Quantidade"
                    gridcolor: 'rgba(0,0,0,0.1)',
                    showgrid: true
                },
                yaxis: {
                    title: '',
                    tickfont: {size: 12}
                },
                plot_bgcolor: cores.light_gray,
                paper_bgcolor: '#FFFFFF',
                font: {family: 'Ubuntu, Arial, sans-serif', color: '#242426'},
                legend: {
                    orientation: 'h',
                    yanchor: 'bottom',
                    y: -0.15,
                    xanchor: 'center',
                    x: 0.5,
                    bgcolor: 'rgba(255,255,255,0.95)',
                    bordercolor: cores.dark_blue,
                    borderwidth: 2
                },
                margin: {t: 20, b: 120, l: 250, r: 150},
                annotations: annotations
            };

            const config = {
                responsive: true,
                displayModeBar: true,
                displaylogo: false,
                modeBarButtonsToRemove: ['lasso2d', 'select2d'],
                toImageButtonOptions: {
                    format: 'png',
                    filename: 'edify_bar_chart',
                    height: 800,
                    width: 1400,
                    scale: 2
                }
            };

            Plotly.newPlot('barsChart', [traceEscolhas, traceConclusoes], layout, config);
        }

        // ============================================
        // RADAR CHART
        // ============================================
        function createRadarChart() {
            const top5 = dados.slice(0, 5);
            
            // Normalizar valores
            const maxEscolhas = Math.max(...top5.map(d => d.escolhas));
            const maxConclusoes = Math.max(...top5.map(d => d.conclusoes));
            const maxTaxa = Math.max(...top5.map(d => d.taxa));

            const coresRadar = [cores.green, cores.light_blue, cores.yellow, '#FF2726', cores.dark_blue];

            const traces = top5.map((d, i) => {
                const escolhasNorm = (d.escolhas / maxEscolhas) * 100;
                const conclusoesNorm = (d.conclusoes / maxConclusoes) * 100;
                const taxaNorm = (d.taxa / maxTaxa) * 100;

                return {
                    type: 'scatterpolar',
                    r: [escolhasNorm, conclusoesNorm, taxaNorm, escolhasNorm],
                    theta: ['üë• Popularidade', '‚úÖ Conclus√µes', 'üéØ Taxa de Reten√ß√£o', 'üë• Popularidade'],
                    fill: 'toself',
                    name: d.topicoSimples,
                    line: {color: coresRadar[i], width: 3},
                    marker: {size: 10, color: coresRadar[i]},
                    opacity: 0.65,
                    customdata: [[d.escolhas, d.conclusoes, d.taxa]],
                    hovertemplate: '<b>%{fullData.name}</b><br><br>' +
                                  '<b>Popularidade:</b> %{customdata[0][0]:,} escolhas<br>' +
                                  '<b>Conclus√µes:</b> %{customdata[0][1]:,} atividades<br>' +
                                  '<b>Taxa:</b> %{customdata[0][2]:.1f}%<br>' +
                                  '<extra></extra>'
                };
            });

            const layout = {
                polar: {
                    radialaxis: {
                        visible: true,
                        range: [0, 110],
                        tickfont: {size: 14, family: 'Ubuntu', color: '#242426'},
                        gridcolor: 'rgba(66, 25, 181, 0.2)',
                        tickvals: [0, 25, 50, 75, 100],
                        ticktext: ['0', '25', '50', '75', '100']
                    },
                    angularaxis: {
                        tickfont: {size: 15, family: 'Ubuntu', color: cores.dark_blue, weight: 'bold'},
                        linecolor: cores.dark_blue,
                        linewidth: 2,
                        gridcolor: 'rgba(66, 25, 181, 0.2)'
                    },
                    bgcolor: cores.light_gray
                },
                showlegend: true,
                legend: {
                    orientation: 'h',
                    yanchor: 'bottom',
                    y: -0.2,
                    xanchor: 'center',
                    x: 0.5,
                    bgcolor: 'rgba(255,255,255,0.95)',
                    bordercolor: cores.dark_blue,
                    borderwidth: 2,
                    font: {size: 14, family: 'Ubuntu'}
                },
                paper_bgcolor: '#FFFFFF',
                font: {family: 'Ubuntu, Arial, sans-serif', color: '#242426'},
                margin: {t: 60, b: 120, l: 100, r: 100},
                hovermode: 'closest'
            };

            const config = {
                responsive: true,
                displayModeBar: true,
                displaylogo: false,
                modeBarButtonsToRemove: ['lasso2d', 'select2d'],
                toImageButtonOptions: {
                    format: 'png',
                    filename: 'edify_radar_chart',
                    height: 700,
                    width: 1400,
                    scale: 2
                }
            };

            Plotly.newPlot('radarChart', traces, layout, config);
        }

        // ============================================
        // INICIALIZA√á√ÉO
        // ============================================
        window.bubbleRendered = false;
        window.barsRendered = false;
        window.radarRendered = false;

        // Renderizar o primeiro gr√°fico ao carregar
        document.addEventListener('DOMContentLoaded', function() {
            createBubbleChart();
            window.bubbleRendered = true;
        });
    </script>
</body>
</html>